# コーディング規約

## 基本ルール
- import は `src` から始まる絶対パスで行うこと

## オブジェクト指向ルール（ThoughtWorksアンソロジー）

以下の9つのルールを必ず遵守すること：

1. **1つのメソッドにつきインデントは1段階までにすること**
2. **else句を使用しないこと**
3. **すべてのプリミティブ型と文字列型をラップすること**
  - 除外パターン
    - テストコードのモック関連コード
    - sendMessageのmessageパラメータ
    - catch節のerrorオブジェクト
4. **1行につきドットは1つまでにすること**
  - 除外パターン
    - chrome APIの呼び出しコード
5. **名前を省略しないこと**
6. **すべてのエンティティを小さくすること**
7. **1つのクラスにつきインスタンス変数は2つまでにすること**
8. **ファーストクラスコレクションを使用すること**
9. **Getter、Setter、プロパティを使用しないこと**

## システム設計原則

### メソッド設計
- **メソッドは必ずインスタンス変数を使う**
  - 除外パターン
    - infrastructure層のコード
- **メソッドを追加・変更する場合は、インスタンス変数を使うものに変更すること**

### クラス設計
- **クラスを新規追加する場合は、単体テストも追加すること**
- **使われないメソッドを作らないこと**
  - いつか使うだろうで、isValideやequalsを乱造しない

## Clean Architectureルール
- **ドメイン層は他の層に依存してはいけない**
- application, componentに、直接記述しては行けないコード
  - chrome APIやwindowオブジェクトを直接使うコード
  - domain層に依存するコード
  - infrastructure層に依存するコード
- componentのメソッド1つからは、極力1つのusecaseメソッドしか呼び出さないこと
- **infrastructure層にのみ、chrome APIやwindowオブジェクトを直接使うコードを書いてよい**
- **Infrastructure層への依存が必要な処理は、Application層のUseCaseに配置するという原則を徹底する**
- application層の依存は、container.tsで解決すること
- application層には、domain層とinfrastructure層の依存を持ち込まないこと



## テストルール

### テストファイル構造
- **テストファイルは必ず対応する実装ファイルと同じディレクトリ構造を持つこと**
- **単体テストは、1メソッドごとに1ファイル以上にすること**
  - クラス単位でまとめない
  - 1メソッドでもあっても、ケースの内容や量によっては、適切に複数ファイルに分割すること

### 実装時の必須チェック
- **追加、変更があったメソッドには必ず単体テストを追加**
- **PRレビュー前に必ずテストを実行して通ることを確認**
