# 振り返り

このファイルで毎日の振り返りを行います。追記専用です。過去の内容を修正しないでください。

## スクラム01 の振り返り
<!-- KPT法で振り返りを行なってください -->

### Keep
<!-- うまく行ったこと、続けていきたいこと -->
- 既存のtestCases配列形式を尊重し、統合する形でテストケースを拡充できた
- 重複テストケースを適切に識別し、17個から12個に統廃合して保守性を向上させた
- 各段階でテストを実行し、品質を確保しながら作業を進められた
- ユーザーからのフィードバックを受けて迅速に修正・改善を行えた
- テストカバレッジを維持しながらコードの重複を排除できた

### Problem
<!-- 問題点、苦労したこと、レビューで指摘を受けたこと -->
- 最初に既存のtestCases配列形式を見落とし、独自の形式でテストを作成してしまった
- 重複テストケースの存在に最初の段階で気づけず、後から統廃合が必要になった
- jsdom環境特有の制約（DOMParserとisEqualNodeの問題）により、一時的な回避策が必要だった
- レビューで重複指摘を受けるまで、テストケースの重複を見逃していた

### Try
<!-- 次回やってみたいこと -->
<!-- タスクベースではなく、行動ルールとして記載してください。 -->
- 既存コードの形式や構造を事前により詳細に調査してから実装を開始する
- テストケース作成前に重複可能性を事前にチェックし、統合を意識して設計する
- テスト環境の制約や特殊事情を事前に把握し、適切な実装方針を立てる
- コードレビュー依頼前に自分でもコードの重複や改善点を再確認する

---

## スクラム02回目 (2025/07/13)

### Keep (良かったこと・続けたいこと)
- 値オブジェクトを導入したことで、プリミティブな文字列が持っていた暗黙的な責務（HTMLであること、タグ名であること）が明確になった。
- `HtmlString`と`TagName`の単体テストを先に作成したことで、安心して`HtmlReplacer`のリファクタリングを進められた。
- レビューコメントに対して迅速に対応し、コードの品質を向上させることができた。
- `TagName.isTableRelated`のようなヘルパーメソッドを値オブジェクトに持たせることで、ロジックの凝集度を高め、ネストを浅くできた。

### Problem (問題点・苦労したこと・レビューで指摘を受けたこと)
- `HtmlReplacer`で`HtmlString`を導入した際、不正なHTML文字列が渡された場合のテストケースで例外が発生し、既存のテストが失敗した。これは`HtmlString`のバリデーションが厳しくなったためだが、`HtmlReplacer`側で適切にハンドリングする必要があった。
- `HtmlString.ts`の`toDomNode`メソッドのネストが深いというレビュー指摘を受け、メソッド抽出と早期リターンで修正するのに時間がかかった。
- `TextReplacer.ts`の変更がIssue範囲外であるという指摘を受け、元の状態に戻す必要があった。

### Try (次回やってみたいこと)
- 新しい値オブジェクトを導入する際は、既存のコードベースとの整合性をより慎重に検討し、影響範囲を事前に把握する。
- 複雑なロジックを持つメソッドをリファクタリングする際は、小さなプライベートメソッドに分割することを初期段階から意識する。
- 複数のクラスにまたがる変更を行う際は、各クラスの責務をより明確に定義し、依存関係を最小限に抑える設計を心がける。
- Issueのスコープを常に意識し、範囲外の変更は行わないように徹底する。

---

## スクラム03回目 (2025/07/13)

### Keep (良かったこと・続けたいこと)
- `HtmlReplacer.ts`のリファクタリングにおいて、早期リターンと正規表現による置換ロジックの導入により、コードの簡潔性と可読性が向上した。
- オブジェクト指向ルールへの準拠を確認し、大きな問題がないことを確認できた。
- 単体テストが全てパスすることを確認し、変更によるデグレードがないことを確認できた。

### Problem (問題点・苦労したこと・レビューで指摘を受けたこと)
- 特になし。

### Try (次回やってみたいこと)
- 今後もリファクタリングを進める際は、オブジェクト指向ルールへの準拠を意識し、コードの品質を維持する。
- 変更を加える前に、関連するテストを十分に確認し、テスト駆動開発の原則を徹底する。

---

## スクラム04回目 (2025/07/13)

### Keep (良かったこと・続けたいこと)
- Strategyパターンを導入することで、HTML文字列からDOMノードへの変換ロジックをポリモーフィズムで分離し、if-else文を排除できた。
- `DomConverterStrategy`インターフェースを定義し、`DefaultDomConverter`と`TableDomConverter`で責務を明確に分離できた。
- `DomConverterFactory`により、タグ名に応じて適切な変換戦略を選択する仕組みを構築し、拡張性を向上させた。
- テストケースの共通化により、`testCases`配列形式に統一し、保守性を向上させた。
- Dockerコンテナ内でのテスト実行により、環境の一貫性を確保できた。
- 各段階で単体テストを確実に実行し、品質を確保しながらリファクタリングを進められた。

### Problem (問題点・苦労したこと・レビューで指摘を受けたこと)
- `HtmlString.ts`から不要な`toDomNode`メソッドを削除する際、依存関係の整理に注意が必要だった。
- `TagName.ts`の`isTableRelated`メソッドで`table`タグが漏れており、修正が必要だった。
- `TableDomConverter.ts`の`convert`メソッドで`table`タグの変換処理が不完全だった。
- テストケース共通化のレビュー指摘を受け、複数回の修正が必要になった。
- テスト実行コマンドがDockerコンテナ内での実行に変更されたが、事前に把握できていなかった。

### Try (次回やってみたいこと)
- 新しいデザインパターンを導入する際は、関連する全てのクラスでの一貫性を事前により詳細に検討する。
- 値オブジェクトのメソッド実装時は、全てのケースを網羅的にテストし、漏れがないか確認する。
- テストケース作成時は最初から共通化を意識し、保守性の高い形式で実装する。
- 開発環境の変更（Docker化など）については、プロジェクト開始時に確認し、一貫したツールチェーンを使用する。
- コードレビューでの指摘事項を事前に自己チェックできるよう、チェックリストを作成し活用する。

---

## スクラム05 の振り返り (2025/07/16)
<!-- KPT法で振り返りを行なってください -->

### Keep (良かったこと・続けたいこと)
- ファーストクラスコレクション（ChildNodeList、HtmlContent）の導入により、配列操作の責務を適切に分離し、可読性が大幅に向上した。
- レビューコメントに対して迅速かつ的確に対応し、8回の改善サイクルを通じて品質を着実に向上させることができた。
- テストコード重複の解消により、保守性を向上させ、テストケースの責務を明確化できた。
- オブジェクト指向設計の原則（CODING_STYLE.mdのルール）に従い、配列をラップするクラスを作成し、より明確な意図を持たせることができた。
- 仕様が未確定な状況に対して柔軟に対応し、将来の変更に備えた実装（HtmlString.isValidを常にtrue）に調整できた。
- 各改善において確実にテストを実行し、デグレードを防止できた。

### Problem (問題点・苦労したこと・レビューで指摘を受けたこと)
- HTMLバリデーション機能の実装において、仕様の確定前に詳細な実装を行ってしまい、後から仕様変更で大幅な修正が必要になった。
- ファーストクラスコレクションの適用範囲について、当初は部分的な適用に留まり、複数回のレビューで追加適用箇所を指摘された。
- 変数名（tempDiv）の意図が不明確で、可読性の問題を指摘された。
- テストケース作成時に、メソッドの責務を正しく理解せずに誤ったテストを作成してしまった（isValidメソッドでtoString()をテスト）。
- 仕様の変更により、実装したHTMLタグ対応関係チェック機能が不要になり、作業が無駄になった。

### Try (次回やってみたいこと)
<!-- タスクベースではなく、行動ルールとして記載してください。 -->
- 仕様が未確定な機能については、詳細実装前に仕様の確定を待つか、より簡潔な実装から始める。
- オブジェクト指向の原則（ファーストクラスコレクション等）を適用する際は、コードベース全体を俯瞰し、適用すべき箇所を包括的に特定する。
- 変数名やメソッド名を決める際は、その責務や意図を明確に表現できているかを事前に確認する。
- テストケース作成時は、テスト対象メソッドの責務と期待される動作を正確に理解してからテストを作成する。
- レビューコメントでの指摘パターンを蓄積し、同様の問題を事前に自己チェックできるようにする。

---

## スクラムkk の振り返り
<!-- KPT法で振り返りを行なってください -->

### Keep
<!-- うまく行ったこと、続けていきたいこと -->

### Problem
<!-- 問題点、苦労したこと、レビューで指摘を受けたこと -->

### Try
<!-- 次回やってみたいこと -->
<!-- タスクベースではなく、行動ルールとして記載してください。 -->
