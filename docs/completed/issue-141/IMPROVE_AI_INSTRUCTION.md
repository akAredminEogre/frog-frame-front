# AI指示改善提案書

このドキュメントは、issue-141のスクラム01〜07で得られた開発者→AIの指示における改善点をまとめたものです。
今後のプロジェクトでのAI活用において、これらの知見を参考にしてください。

## ワークフロー・実行手順に関する改善点

### workflow参照エラー・実行コマンドの明確化
- **問題**: `workflow-test-check-before-complete` が存在しないのに参照されている問題があった
- **改善**: 実際には `make testlint` を実行すべきであることを `workflow-code-according-to-the-rules` に明記する必要がある
- **対象スクラム**: スクラム01

### ワークフローファイル名の混同防止
- **問題**: `workflow-see-and-commit-review-comment-then-code-again.md` で `workflow-record-progress` を参照しているが、`workflow-record-progress-after-coding` と混同しやすい
- **改善**: ファイル名を明確に区別できるよう改善が必要
- **対象スクラム**: スクラム02

### 包括的な一括対応の推奨
- **問題**: 段階的改善よりも、包括的な一括対応を推奨するガイドラインの整備が必要
- **改善**: 大規模リファクタリング時は、段階的改善よりも最終形を見据えた一括実装を目指す
- **対象スクラム**: スクラム05, 06

## 開発・設計に関する改善点

### システム主要機能の明確化
- **問題**: システムの主要機能について明確な定義をプロジェクト文書に記載する必要がある
- **改善**: 正規表現置換、文字列置換、DOM保持等の主要機能定義をドキュメント化
- **対象スクラム**: スクラム03

### E2Eテスト失敗時の評価基準
- **問題**: E2Eテスト失敗時の評価基準を明確化し、「部分的成功」の判断基準をより厳格にする必要がある
- **改善**: レビューコメント対応時は、技術的修正だけでなくシステム理解の見直しも含めた包括的な対応を促すガイドラインが必要
- **対象スクラム**: スクラム03

### 設計原則の理解促進
- **問題**: レビューコメント対応時は、指摘内容の背景にある設計原則も含めて理解するよう促すガイドラインが必要
- **改善**: 既存コードの責務範囲を正確に理解するための調査手順を標準化する必要がある
- **改善**: 段階的改善ではなく本質的解決を重視する開発方針をワークフローに組み込むことを提案する
- **対象スクラム**: スクラム04

### 計画と実作業の乖離管理
- **問題**: 計画と実際の作業内容の乖離が生じた場合の対応手順を明確化する必要がある
- **改善**: 計画と実作業内容に乖離が生じた場合は、早期に方向性を調整する
- **対象スクラム**: スクラム04

## テスト・品質管理に関する改善点

### テスト規約の早期適用
- **問題**: テスト規約（Abendディレクトリ使用、describe分離）をより早期に適用できるよう、workflow-code-according-to-the-rulesでの記載を強化する必要がある
- **改善**: テスト実装時は最初からプロジェクトのテスト規約（Abend使用、describe分離）を適用する
- **対象スクラム**: スクラム02

### 調査専用スクラムのガイドライン
- **問題**: 調査専用のスクラムの場合、テスト実行の必要性について明確な指針があると良い
- **改善**: 調査のみの場合のテスト実行要否を明確化
- **対象スクラム**: スクラム01

### HTMLテストデータの妥当性チェック（実装済み）
- **問題**: Table要素のテストケースで不正なHTML構造（tr要素を単体で使用）を使用し、修正が必要になった
- **改善**: テストケース作成時のHTML構造妥当性チェックをテスト規約に追加することを提案する（table/tr/td関係等）
- **対象スクラム**: スクラム06
- **実装状況**: `.clinerules/03-test-coding-standards/01-common-rule/01-02-array-based-test.md` に実装済み

### E2Eテストのタイムアウト管理
- **問題**: E2Eテストのタイムアウト管理について、適切な実行時間設定のガイドラインを整備することを提案する
- **改善**: テスト実行時間の長期化に対して、並列実行やタイムアウト調整などの対策を事前に検討する
- **対象スクラム**: スクラム05

## YAGNI原則・過剰設計の防止

### YAGNI原則の明記
- **問題**: 不要メソッド作成を防ぐため、YAGNI原則の適用をworkflow-code-according-to-the-rulesに明記することを提案する
- **改善**: 設計時にはYAGNI原則を重視し、不要な機能（デバッグ用メソッド等）は最初から作らない
- **対象スクラム**: スクラム02

### Strategy Pattern等設計パターンの適用指針
- **問題**: Strategy Pattern等の設計パターン実装時は、過度な抽象化を避けYAGNI原則を重視するガイドラインが必要
- **改善**: Strategy Patternなどの設計パターン適用時は、最初から統合されたシンプルなアプローチを検討する
- **対象スクラム**: スクラム05

### HTML/DOM関連の実装事前確認
- **問題**: HTML/DOM関連の実装では、ブラウザ仕様の事前確認を促すチェックリストを追加することを提案する
- **改善**: HTML構造や DOM仕様に関わる実装前は、仕様調査と簡単な動作確認を先行して実施する
- **対象スクラム**: スクラム05

## アーキテクチャ・PRレビュー対応に関する改善点

### アーキテクチャ状況調査の必須化
- **問題**: PRレビュー対応workflow開始時に、現在のアーキテクチャ状況調査を必須ステップとして組み込むことを提案する
- **改善**: PRレビュー対応開始時に、現在のアーキテクチャと関連クラスの存在状況を事前調査する
- **対象スクラム**: スクラム06

### レビューコメント対応の早期特定
- **問題**: レビューコメントで指摘された不足項目（テストケース数、機能カバレッジ）の早期特定手順を標準化する必要がある
- **改善**: テストカバレッジの充実度を初期段階で評価し、不足分を早期に特定・対応する
- **対象スクラム**: スクラム06

## ドキュメント・コミュニケーションに関する改善点

### タスク定義の具体化
- **問題**: 「ドキュメント更新」タスクは具体的な更新対象（README、CLAUDE.md、ISSUE.md等）を明記することを推奨する
- **改善**: タスク定義時に「ドキュメント更新」のような抽象的表現を避け、具体的な更新対象と内容を明記する
- **対象スクラム**: スクラム07

### プロジェクト受け入れ条件の管理
- **問題**: プロジェクト受け入れ条件は初期段階で明確化し、進捗確認時に定期的にチェックできるよう整備が必要
- **改善**: プロジェクト完了時には受け入れ条件の充足状況を体系的に確認する手順を確立する
- **対象スクラム**: スクラム07

### レビューコメント回答の方針整理
- **問題**: レビューコメントに対する回答では、どのファイルをどのように更新するかの方針を先に整理することを提案する
- **改善**: レビューコメントに回答する際は、具体的なファイル名と更新内容を整理してから作業に取り組む
- **対象スクラム**: スクラム07

### AI指示改善の継続性
- **問題**: HTML妥当性チェックのようなテスト品質向上のガイドラインは、実際の問題発生時に即座に規約に反映することを推奨する
- **改善**: AI指示改善は継続的に実施し、得られた知見を.clinerules に蓄積する
- **対象スクラム**: スクラム07

## 実装済み改善項目


## 今後の実装推奨項目

以下の項目は、今後のプロジェクトにおいて.clinerulesへの実装を検討することを推奨します：

1. `workflow-code-according-to-the-rules`へのmake testlintの明記
2. ワークフローファイル名の重複・混同回避
3. システム主要機能定義のドキュメント化
4. E2Eテスト失敗時の評価基準の明確化
5. 設計原則理解のためのガイドライン
6. PRレビュー対応時のアーキテクチャ調査の必須化
7. YAGNI原則の明確な組み込み
8. タスク定義の具体性要求
9. プロジェクト受け入れ条件管理フロー