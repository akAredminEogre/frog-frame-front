# 振り返り

このファイルで毎日の振り返りを行います。追記専用です。過去の内容を修正しないでください。

## スクラム01 の振り返り
<!-- KPT法で振り返りを行なってください -->

### Keep
- E2Eテストが失敗した際に、原因を一つずつ切り分け、粘り強く複数の解決策を試すことができた。
- 最終的に、テストの実行順序とタイミングの問題を特定し、`popupPage.reload()`を挟むことで安定してテストを成功させることができた。
- `fixtures.ts`を修正した際に、影響範囲である`popup.spec.ts`の修正も忘れずに行うことができた。

### Problem
- PlaywrightのE2Eテストで、拡張機能の非同期な動作（特に`chrome.tabs`や`chrome.windows` APIの利用）に起因するタイミング問題に直面し、解決に時間を要した。
- `waitForFunction`がCSP違反で使えないなど、拡張機能のテスト特有の制約について、試行錯誤するまで気づけなかった。
- `expect.poll`も同様にCSP違反となり、解決策として適切ではなかった。

### Try
- 拡張機能のE2Eテストで非同期処理を扱う際は、単純な`waitForTimeout`に頼るのではなく、`toHaveValue`の`timeout`オプションや、テスト実行順序の工夫（リロードなど）を最初から検討する。
- テストが失敗した場合、プロダクションコードの問題だけでなく、テスト環境特有の問題（フォーカス、タイミング、CSPなど）を疑う視点を常に持つ。

